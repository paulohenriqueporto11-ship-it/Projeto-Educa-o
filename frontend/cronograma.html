<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronograma - Estuda.IA</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4F46E5">
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

    <nav>
        <div class="logo">✨ Estuda.IA</div>
        <a href="index.html" class="btn-outline" style="border:none; font-weight:600;">← Voltar</a>
    </nav>

    <div class="container">
        
        <div class="progress-header">
            <div class="progress-info">
                <h2>Jornada da Aprovação</h2>
                <p>Clique nos tópicos para assistir às aulas e marcar como concluído.</p>
            </div>
            
            <div class="circle-chart">
                <svg viewBox="0 0 36 36" class="circular-chart">
                    <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                    <path class="circle" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" stroke="#4F46E5" id="circlePath" />
                    <text x="18" y="20.35" class="percentage" id="percentText">0%</text>
                </svg>
            </div>
        </div>

        <div id="modulesContainer"></div>

    </div>

    <script>
        // --- CURADORIA DE CONTEÚDO (Vídeos Reais do Youtube) ---
        const studyData = [
            {
                id: 1,
                title: "Módulo 1: Estrutura da Redação",
                tasks: [
                    { 
                        title: "Modelo de Redação Nota 1000", 
                        video: "yvl3KjdV2ZM", // ID do Youtube
                        desc: "Entenda a estrutura básica: Introdução, Desenvolvimento e Conclusão. Veja como planejar o texto antes de escrever."
                    },
                    { 
                        title: "Como fazer uma Introdução Perfeita", 
                        video: "7J0V0X6Z8ws", 
                        desc: "Aprenda a apresentar o tema, fazer a contextualização histórica e definir sua tese logo no primeiro parágrafo."
                    }
                ]
            },
            {
                id: 2,
                title: "Módulo 2: Gramática Essencial (C1)",
                tasks: [
                    { 
                        title: "Crase sem mistério", 
                        video: "3f3_2X2_1qM", 
                        desc: "Nunca mais erre a crase. Regras práticas de quando usar, quando não usar e casos facultativos."
                    },
                    { 
                        title: "Uso da Vírgula", 
                        video: "g_5z5z5z5z5", // Placeholder
                        desc: "A vírgula muda o sentido da frase. Aprenda a separar orações e isolar termos explicativos."
                    }
                ]
            },
            {
                id: 3,
                title: "Módulo 3: Argumentação (C3)",
                tasks: [
                    { 
                        title: "Como usar Repertório Sociocultural", 
                        video: "example123", 
                        desc: "Citações coringas de filósofos, filmes e livros que servem para vários temas."
                    },
                    { 
                        title: "Projeto de Texto", 
                        video: "example456", 
                        desc: "Como organizar seus argumentos para não se perder e garantir a progressão textual."
                    }
                ]
            }
        ];

        // --- LÓGICA ---
        const savedProgress = JSON.parse(localStorage.getItem('estudaia_progress')) || {};

        function renderModules() {
            const container = document.getElementById('modulesContainer');
            let totalTasks = 0, completedTasks = 0;
            let html = '';

            studyData.forEach(mod => {
                let tasksHtml = '';
                mod.tasks.forEach((task, index) => {
                    const taskId = `${mod.id}_${index}`;
                    const isChecked = savedProgress[taskId] ? 'checked' : '';
                    if(isChecked) completedTasks++;
                    totalTasks++;

                    // Item da Lista com Conteúdo Expansível
                    tasksHtml += `
                        <div class="task-item-wrapper" id="row_${taskId}">
                            <div class="task-item">
                                <input type="checkbox" class="custom-checkbox" id="${taskId}" ${isChecked} onchange="toggleTask('${taskId}')">
                                <span class="task-label" onclick="toggleLesson('${taskId}')">${task.title}</span>
                                <button class="btn-expand" onclick="toggleLesson('${taskId}')">▼</button>
                            </div>
                            
                            <div class="lesson-content" id="lesson_${taskId}">
                                <div class="video-responsive">
                                    <iframe src="https://www.youtube.com/embed/${task.video}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                                <div class="lesson-summary">
                                    <h4>Resumo da Aula</h4>
                                    <p>${task.desc}</p>
                                    <button class="btn btn-outline" style="font-size:0.8rem; padding: 5px 10px;" onclick="toggleTask('${taskId}', true)">Marcar como Concluído</button>
                                </div>
                            </div>
                        </div>
                    `;
                });

                html += `
                    <div class="module-card">
                        <div class="module-header">
                            <span class="module-title">${mod.title}</span>
                            <span class="module-badge">${mod.tasks.length} Aulas</span>
                        </div>
                        <div class="task-list">${tasksHtml}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
            updateChart(completedTasks, totalTasks);
        }

        // Abre/Fecha o conteúdo da aula
        function toggleLesson(id) {
            const content = document.getElementById(`lesson_${id}`);
            const isVisible = content.classList.contains('active');
            
            // Fecha todos
            document.querySelectorAll('.lesson-content').forEach(el => el.classList.remove('active'));
            
            // Abre o clicado se não estava aberto
            if(!isVisible) content.classList.add('active');
        }

        function toggleTask(id, forceCheck = false) {
            const checkbox = document.getElementById(id);
            if(forceCheck) checkbox.checked = true;

            if (checkbox.checked) {
                savedProgress[id] = true;
            } else {
                delete savedProgress[id];
            }
            
            localStorage.setItem('estudaia_progress', JSON.stringify(savedProgress));
            
            // Atualiza gráfico
            let total = document.querySelectorAll('.custom-checkbox').length;
            let checked = document.querySelectorAll('.custom-checkbox:checked').length;
            updateChart(checked, total);
        }

        function updateChart(completed, total) {
            const percent = total === 0 ? 0 : Math.round((completed / total) * 100);
            const circle = document.getElementById('circlePath');
            const text = document.getElementById('percentText');
            
            circle.setAttribute('stroke-dasharray', `${percent}, 100`);
            text.textContent = `${percent}%`;
            circle.setAttribute('stroke', percent === 100 ? '#10B981' : '#4F46E5');
        }

        renderModules();
    </script>
</body>
</html>
