<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronograma - Estuda.IA</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4F46E5">
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

    <nav>
        <div class="logo">‚ú® Estuda.IA</div>
        <a href="index.html" class="btn-outline" style="border:none; font-weight:600;">‚Üê Voltar</a>
    </nav>

    <div class="container">
        
        <div class="progress-header">
            <div class="progress-info">
                <h2>Jornada da Nota 1000</h2>
                <p>Complete os m√≥dulos para dominar todas as compet√™ncias do ENEM.</p>
            </div>
            
            <div class="circle-chart">
                <svg viewBox="0 0 36 36" class="circular-chart">
                    <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                    <path class="circle" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" stroke="#4F46E5" id="circlePath" />
                    <text x="18" y="20.35" class="percentage" id="percentText">0%</text>
                </svg>
            </div>
        </div>

        <div id="modulesContainer"></div>

    </div>

    <script>
        // --- DADOS DO CRONOGRAMA (Conte√∫do Educacional) ---
        const studyData = [
            {
                id: 1,
                title: "M√≥dulo 1: A Estrutura Perfeita",
                tasks: [
                    "Entendendo a estrutura Dissertativo-Argumentativa",
                    "Como fazer uma Introdu√ß√£o (Tese + Contexto)",
                    "Desenvolvimento: T√≥pico Frasal e Argumenta√ß√£o",
                    "Conclus√£o: Os 5 elementos da Interven√ß√£o"
                ]
            },
            {
                id: 2,
                title: "M√≥dulo 2: Compet√™ncia 1 (Gram√°tica)",
                tasks: [
                    "Uso da Crase (Regras b√°sicas e exce√ß√µes)",
                    "Concord√¢ncia Verbal e Nominal",
                    "Pontua√ß√£o: Uso correto da v√≠rgula",
                    "Acentua√ß√£o e Ortografia oficial"
                ]
            },
            {
                id: 3,
                title: "M√≥dulo 3: Compet√™ncia 2 & 3 (Argumenta√ß√£o)",
                tasks: [
                    "Como usar Repert√≥rio Sociocultural (Alus√µes)",
                    "Evitando o Tangenciamento do Tema",
                    "Projeto de Texto: Organizando ideias",
                    "Estrat√©gias Argumentativas (Causa e Consequ√™ncia)"
                ]
            },
            {
                id: 4,
                title: "M√≥dulo 4: Coes√£o Textual (C4)",
                tasks: [
                    "Conectivos de In√≠cio de Par√°grafo",
                    "Conectivos Interfrasais (Dentro das frases)",
                    "Evitando repeti√ß√£o de palavras (Sin√¥nimos)",
                    "Operadores Argumentativos"
                ]
            }
        ];

        // --- L√ìGICA DO APP ---
        
        // 1. Carregar progresso salvo
        const savedProgress = JSON.parse(localStorage.getItem('estudaia_progress')) || {};

        function renderModules() {
            const container = document.getElementById('modulesContainer');
            let totalTasks = 0;
            let completedTasks = 0;

            let html = '';

            studyData.forEach(mod => {
                let tasksHtml = '';
                mod.tasks.forEach((task, index) => {
                    const taskId = `${mod.id}_${index}`;
                    const isChecked = savedProgress[taskId] ? 'checked' : '';
                    if(isChecked) completedTasks++;
                    totalTasks++;

                    tasksHtml += `
                        <div class="task-item ${isChecked ? 'completed' : ''}" id="row_${taskId}">
                            <input type="checkbox" class="custom-checkbox" id="${taskId}" ${isChecked} onchange="toggleTask('${taskId}')">
                            <label for="${taskId}" class="task-label">${task}</label>
                        </div>
                    `;
                });

                html += `
                    <div class="module-card">
                        <div class="module-header">
                            <span class="module-title">
                                ${savedProgress[`mod_${mod.id}_done`] ? '‚úÖ' : 'üìö'} ${mod.title}
                            </span>
                            <span class="module-badge">${mod.tasks.length} Aulas</span>
                        </div>
                        <div class="task-list">
                            ${tasksHtml}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
            updateChart(completedTasks, totalTasks);
        }

        function toggleTask(id) {
            // Salva estado
            const checkbox = document.getElementById(id);
            if (checkbox.checked) {
                savedProgress[id] = true;
                document.getElementById(`row_${id}`).classList.add('completed');
            } else {
                delete savedProgress[id];
                document.getElementById(`row_${id}`).classList.remove('completed');
            }
            
            localStorage.setItem('estudaia_progress', JSON.stringify(savedProgress));
            
            // Recalcula gr√°fico sem recarregar tudo
            let total = document.querySelectorAll('.custom-checkbox').length;
            let checked = document.querySelectorAll('.custom-checkbox:checked').length;
            updateChart(checked, total);
        }

        function updateChart(completed, total) {
            const percent = total === 0 ? 0 : Math.round((completed / total) * 100);
            
            // Anima√ß√£o do SVG
            const circle = document.getElementById('circlePath');
            const text = document.getElementById('percentText');
            
            // Stroke Dasharray: "value, 100"
            circle.setAttribute('stroke-dasharray', `${percent}, 100`);
            text.textContent = `${percent}%`;
            
            // Muda cor se completou tudo
            if(percent === 100) circle.setAttribute('stroke', '#10B981');
            else circle.setAttribute('stroke', '#4F46E5');
        }

        // Inicializa
        renderModules();

    </script>
</body>
</html>
