<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulados Pro - Estuda.IA</title>
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

    <div id="loadingScreen" class="loading-screen">
        <div class="loader"></div>
        <p style="margin-top:15px; color:var(--text-muted)">Conectando ao servidor...</p>
    </div>

    <nav>
        <div class="logo">âœ¨ Estuda.IA</div>
        <a href="index.html" class="btn-outline" style="border:none; font-weight:600;">â† Voltar</a>
    </nav>

    <div class="container" style="min-height: 80vh; display: flex; align-items: center; justify-content: center;">
        
        <div id="menuScreen" style="width: 100%; display:none;">
            <div style="text-align: center; margin-bottom: 30px;">
                <h1 style="margin-bottom: 10px;">Simulados</h1>
                <p style="color:var(--text-muted);">QuestÃµes inteligentes que nÃ£o se repetem.</p>
                <small id="progressoTotal" style="color:var(--primary); font-weight:bold;">Carregando stats...</small>
            </div>

            <div class="subjects-grid">
                <div class="subject-card" onclick="openSubMenu('Humanas')"><span class="subject-icon">ğŸ›ï¸</span><span class="subject-title">Humanas</span></div>
                <div class="subject-card" onclick="openSubMenu('Natureza')"><span class="subject-icon">ğŸ§¬</span><span class="subject-title">Natureza</span></div>
                <div class="subject-card" onclick="openSubMenu('Linguagens')"><span class="subject-icon">ğŸ“š</span><span class="subject-title">Linguagens</span></div>
                <div class="subject-card" onclick="openSubMenu('MatemÃ¡tica')"><span class="subject-icon">ğŸ“</span><span class="subject-title">MatemÃ¡tica</span></div>
            </div>
            
            <div style="margin-top:20px; text-align:center;">
                <button class="btn-outline" onclick="startQuizGlobal()" style="width:100%; max-width:300px;">ğŸ² Modo AleatÃ³rio (Tudo)</button>
            </div>
        </div>

        <div id="selectionScreen" style="display: none; width: 100%; max-width: 500px;">
            <div style="text-align:center;">
                <h2 id="selectionTitle" style="margin-bottom:5px;">MatemÃ¡tica</h2>
                <p style="color:var(--text-muted); font-size:0.9rem;">Selecione os tÃ³picos:</p>
            </div>
            <div class="topics-grid" id="topicsContainer"></div>
            <div style="display:flex; gap:10px;">
                <button class="btn-outline" onclick="backToMenu()" style="flex:1;">Voltar</button>
                <button class="btn" onclick="confirmStart()" style="flex:1;">Iniciar</button>
            </div>
        </div>

        <div id="quizScreen" class="quiz-container" style="display: none;">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <span class="badge-subject" id="subjectTag">Geral</span>
                <span style="font-weight:600; color:var(--text-muted);">QuestÃ£o <span id="qIndex">1</span>/<span id="qTotal">5</span></span>
            </div>
            <div class="question-text" id="questionText">...</div>
            <div class="options-grid" id="optionsContainer"></div>
        </div>

        <div id="resultScreen" class="quiz-container" style="display: none;">
            <div style="font-size: 4rem;">ğŸ†</div>
            <h2 style="margin-bottom: 10px;">Resultado</h2>
            <div class="quiz-score" id="finalScore">0/5</div>
            <p id="feedbackText" style="margin-bottom: 20px; color:var(--text-muted);">Salvando seu progresso...</p>
            <button class="btn" onclick="location.reload()">Novo Simulado</button>
        </div>

    </div>

    <script>
        // --- 1. CONFIGURAÃ‡ÃƒO API ---
        const API_BASE = "https://backend-redacao.onrender.com/api/simulados";

        // Recupera ID do usuÃ¡rio
        let userId = localStorage.getItem('estuda_ia_userid');
        if (!userId) {
            userId = 'user_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('estuda_ia_userid', userId);
        }

           // --- 2. BANCO DE QUESTÃ•ES (FRONTEND) ---
        const database = [
            // ================= MATEMÃTICA =================
            
            // --- SUB: GEOMETRIA ---
            { id: "MAT-GEO-001", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A soma dos Ã¢ngulos internos de um triÃ¢ngulo Ã©:", opt: ["180Â°", "360Â°", "90Â°", "270Â°"], cor: 0 },
            { id: "MAT-GEO-002", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Volume do cubo de aresta 2cm:", opt: ["4cmÂ³", "8cmÂ³", "6cmÂ³", "12cmÂ³"], cor: 1 },
            { id: "MAT-GEO-003", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Ãrea do cÃ­rculo de raio 3cm (use Ï€=3):", opt: ["18cmÂ²", "27cmÂ²", "9cmÂ²", "30cmÂ²"], cor: 1 },
            { id: "MAT-GEO-004", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual sÃ³lido geomÃ©trico Ã© estudado como 'corpo redondo'?", opt: ["Cubo", "Prisma", "Cilindro", "PirÃ¢mide"], cor: 2 },
            { id: "MAT-GEO-005", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Um triÃ¢ngulo com lados 3, 4 e 5 Ã©:", opt: ["EquilÃ¡tero", "IsÃ³sceles", "RetÃ¢ngulo", "ObtusÃ¢ngulo"], cor: 2 },
            { id: "MAT-GEO-006", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A fÃ³rmula da Ã¡rea do trapÃ©zio Ã©:", opt: ["(B+b).h/2", "b.h", "lÂ²", "Ï€.rÂ²"], cor: 0 },
            { id: "MAT-GEO-007", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A soma dos Ã¢ngulos externos de qualquer polÃ­gono convexo Ã©:", opt: ["180Â°", "360Â°", "540Â°", "90Â°"], cor: 1 },
            { id: "MAT-GEO-008", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Quantas diagonais tem um quadrado?", opt: ["1", "2", "4", "0"], cor: 1 },
            { id: "MAT-GEO-009", cat: "MatemÃ¡tica", sub: "Geometria", txt: "O Teorema de Tales trata de:", opt: ["TriÃ¢ngulos RetÃ¢ngulos", "Retas paralelas cortadas por transversais", "CÃ­rculos", "Ãreas de polÃ­gonos"], cor: 1 },
            { id: "MAT-GEO-010", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual a fÃ³rmula do volume de um cilindro?", opt: ["Ï€.rÂ²", "Ï€.rÂ².h", "2.Ï€.r", "4/3.Ï€.rÂ³"], cor: 1 },
            { id: "MAT-GEO-011", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Um Ã¢ngulo maior que 90Â° e menor que 180Â° Ã©:", opt: ["Agudo", "Reto", "Obtuso", "Raso"], cor: 2 },
            { id: "MAT-GEO-012", cat: "MatemÃ¡tica", sub: "Geometria", txt: "O perÃ­metro de um quadrado de lado 5cm Ã©:", opt: ["10cm", "15cm", "20cm", "25cm"], cor: 2 },
            { id: "MAT-GEO-013", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Dois Ã¢ngulos cuja soma Ã© 90Â° sÃ£o chamados de:", opt: ["Suplementares", "Complementares", "Opostos", "Alternos"], cor: 1 },
            { id: "MAT-GEO-014", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual polÃ­gono tem 5 lados?", opt: ["HexÃ¡gono", "HeptÃ¡gono", "PentÃ¡gono", "OctÃ³gono"], cor: 2 },
            { id: "MAT-GEO-015", cat: "MatemÃ¡tica", sub: "Geometria", txt: "O ponto central de uma circunferÃªncia atÃ© a borda chama-se:", opt: ["DiÃ¢metro", "Raio", "Corda", "Tangente"], cor: 1 },
            { id: "MAT-GEO-016", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A Ã¡rea de um retÃ¢ngulo de base 10 e altura 5 Ã©:", opt: ["15", "50", "25", "100"], cor: 1 },
            { id: "MAT-GEO-017", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A soma dos Ã¢ngulos externos de um triÃ¢ngulo Ã©:", opt: ["180Â°", "360Â°", "270Â°", "90Â°"], cor: 1 },
            { id: "MAT-GEO-018", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual triÃ¢ngulo tem os 3 lados diferentes?", opt: ["EquilÃ¡tero", "IsÃ³sceles", "Escaleno", "RetÃ¢ngulo"], cor: 2 },
            { id: "MAT-GEO-019", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A fÃ³rmula 4/3.Ï€.rÂ³ calcula o volume de:", opt: ["Esfera", "Cilindro", "Cone", "Cubo"], cor: 0 },
            { id: "MAT-GEO-020", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Um Ã¢ngulo de 180Â° Ã© chamado de:", opt: ["Reto", "Agudo", "Raso", "Completo"], cor: 2 },
            { id: "MAT-GEO-021", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Quantos graus tem uma volta completa?", opt: ["180Â°", "270Â°", "360Â°", "100Â°"], cor: 2 },
            { id: "MAT-GEO-022", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A Ã¡rea de um quadrado de lado 10m Ã©:", opt: ["40mÂ²", "100mÂ²", "20mÂ²", "10mÂ²"], cor: 1 },
            { id: "MAT-GEO-023", cat: "MatemÃ¡tica", sub: "Geometria", txt: "O que Ã© uma corda na circunferÃªncia?", opt: ["Segmento que liga dois pontos da borda", "O raio", "O centro", "A tangente"], cor: 0 },
            { id: "MAT-GEO-024", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Quantos lados tem um decÃ¡gono?", opt: ["8", "10", "12", "20"], cor: 1 },
            { id: "MAT-GEO-025", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Dois triÃ¢ngulos sÃ£o semelhantes se tiverem:", opt: ["Mesma Ã¡rea", "Lados iguais", "Ã‚ngulos iguais", "Mesmo perÃ­metro"], cor: 2 },
            { id: "MAT-GEO-026", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Volume de um paralelepÃ­pedo de dimensÃµes 2, 3 e 4:", opt: ["9", "24", "12", "48"], cor: 1 },
            { id: "MAT-GEO-027", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Num triÃ¢ngulo retÃ¢ngulo, o lado oposto ao Ã¢ngulo reto Ã© a:", opt: ["Cateto", "Altura", "Hipotenusa", "Mediana"], cor: 2 },
            { id: "MAT-GEO-028", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A soma dos Ã¢ngulos internos de um quadrado Ã©:", opt: ["180Â°", "360Â°", "540Â°", "720Â°"], cor: 1 },
            { id: "MAT-GEO-029", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual figura tem 4 lados iguais, mas Ã¢ngulos nÃ£o retos?", opt: ["Quadrado", "RetÃ¢ngulo", "Losango", "TrapÃ©zio"], cor: 2 },
            { id: "MAT-GEO-030", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Se o raio Ã© 5, o diÃ¢metro Ã©:", opt: ["2,5", "5", "10", "15"], cor: 2 },
            { id: "MAT-GEO-031", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Ãrea do triÃ¢ngulo de base 8 e altura 4:", opt: ["32", "16", "12", "64"], cor: 1 },
            { id: "MAT-GEO-032", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Quantas arestas tem um cubo?", opt: ["6", "8", "12", "16"], cor: 2 },
            { id: "MAT-GEO-033", cat: "MatemÃ¡tica", sub: "Geometria", txt: "PlanificaÃ§Ã£o de um cilindro gera:", opt: ["2 CÃ­rculos e 1 RetÃ¢ngulo", "1 CÃ­rculo e 1 TriÃ¢ngulo", "6 Quadrados", "1 CÃ­rculo e 1 Setor"], cor: 0 },
            { id: "MAT-GEO-034", cat: "MatemÃ¡tica", sub: "Geometria", txt: "O ponto de encontro das medianas de um triÃ¢ngulo Ã© o:", opt: ["Baricentro", "Ortocentro", "Incentro", "Circuncentro"], cor: 0 },
            { id: "MAT-GEO-035", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A reta que toca a circunferÃªncia em um Ãºnico ponto Ã©:", opt: ["Secante", "Tangente", "Externa", "DiÃ¢metro"], cor: 1 },
            { id: "MAT-GEO-036", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual polÃ­gono nÃ£o possui diagonais?", opt: ["Quadrado", "PentÃ¡gono", "TriÃ¢ngulo", "HexÃ¡gono"], cor: 2 },
            { id: "MAT-GEO-037", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Um Ã¢ngulo de 90Â° graus tambÃ©m Ã© chamado de:", opt: ["Ã‚ngulo Raso", "Ã‚ngulo Reto", "Ã‚ngulo Agudo", "Ã‚ngulo Obtuso"], cor: 1 },
            { id: "MAT-GEO-038", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A soma dos Ã¢ngulos internos de um pentÃ¡gono Ã©:", opt: ["180Â°", "360Â°", "540Â°", "720Â°"], cor: 2 },
            { id: "MAT-GEO-039", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual Ã© o valor do perÃ­metro de um cÃ­rculo de raio 1? (Use Ï€=3,14)", opt: ["3,14", "6,28", "9,42", "12,56"], cor: 1 },
            { id: "MAT-GEO-040", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual sÃ³lido Ã© formado por 4 triÃ¢ngulos equilÃ¡teros?", opt: ["Cubo", "Tetraedro", "Octaedro", "Dodecaedro"], cor: 1 },
            { id: "MAT-GEO-041", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A Ã¡rea de um losango de diagonais 10 e 6 Ã©:", opt: ["60", "30", "16", "100"], cor: 1 },
            { id: "MAT-GEO-042", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Quantos graus tem cada Ã¢ngulo interno de um triÃ¢ngulo equilÃ¡tero?", opt: ["45Â°", "60Â°", "90Â°", "30Â°"], cor: 1 },
            { id: "MAT-GEO-043", cat: "MatemÃ¡tica", sub: "Geometria", txt: "O volume de uma esfera de raio R Ã©:", opt: ["4.Ï€.RÂ²", "4/3.Ï€.RÂ³", "Ï€.RÂ²", "2.Ï€.R"], cor: 1 },
            { id: "MAT-GEO-044", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A soma dos Ã¢ngulos internos de um hexÃ¡gono Ã©:", opt: ["360Â°", "540Â°", "720Â°", "900Â°"], cor: 2 },
            { id: "MAT-GEO-045", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Se o diÃ¢metro Ã© 12cm, o raio mede:", opt: ["24cm", "12cm", "6cm", "3cm"], cor: 2 },
            { id: "MAT-GEO-046", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual destes nÃ£o Ã© um quadrilÃ¡tero?", opt: ["TrapÃ©zio", "Losango", "PentÃ¡gono", "RetÃ¢ngulo"], cor: 2 },
            { id: "MAT-GEO-047", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A geratriz, altura e raio formam triÃ¢ngulo retÃ¢ngulo em qual sÃ³lido?", opt: ["Cubo", "Esfera", "Cone", "Prisma"], cor: 2 },
            { id: "MAT-GEO-048", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Um Ã¢ngulo de 45Â° Ã© a bissetriz de um Ã¢ngulo de:", opt: ["30Â°", "60Â°", "90Â°", "180Â°"], cor: 2 },
            { id: "MAT-GEO-049", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Seno de 30Â° vale:", opt: ["1/2", "âˆš3/2", "âˆš2/2", "1"], cor: 0 },
            { id: "MAT-GEO-050", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Tangente Ã© a razÃ£o entre:", opt: ["Seno e Cosseno", "Cosseno e Seno", "Hipotenusa e Cateto", "Cateto e Hipotenusa"], cor: 0 },
            { id: "MAT-GEO-051", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Num triÃ¢ngulo retÃ¢ngulo, cateto oposto sobre hipotenusa Ã©:", opt: ["Cosseno", "Seno", "Tangente", "Secante"], cor: 1 },
            { id: "MAT-GEO-052", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A Ã¡rea total de um cubo de aresta 2 Ã©:", opt: ["4", "8", "16", "24"], cor: 3 },
            { id: "MAT-GEO-053", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Duas retas que nunca se cruzam sÃ£o:", opt: ["Perpendiculares", "Concorrentes", "Paralelas", "Coincidentes"], cor: 2 },
            { id: "MAT-GEO-054", cat: "MatemÃ¡tica", sub: "Geometria", txt: "O Teorema de PitÃ¡goras Ã©:", opt: ["aÂ² = bÂ² + cÂ²", "a = b + c", "aÂ² = b + c", "a = bÂ² + cÂ²"], cor: 0 },
            { id: "MAT-GEO-055", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual o complemento de um Ã¢ngulo de 30Â°?", opt: ["60Â°", "90Â°", "150Â°", "180Â°"], cor: 0 },
            { id: "MAT-GEO-056", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Qual o suplemento de um Ã¢ngulo de 100Â°?", opt: ["10Â°", "80Â°", "90Â°", "260Â°"], cor: 1 },
            { id: "MAT-GEO-057", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Um polÃ­gono regular tem:", opt: ["Lados iguais e Ã¢ngulos diferentes", "Lados diferentes", "Lados e Ã¢ngulos congruentes", "Nenhuma das anteriores"], cor: 2 },
            { id: "MAT-GEO-058", cat: "MatemÃ¡tica", sub: "Geometria", txt: "A distÃ¢ncia entre dois pontos A(0,0) e B(3,4) Ã©:", opt: ["3", "4", "5", "7"], cor: 2 },
            { id: "MAT-GEO-059", cat: "MatemÃ¡tica", sub: "Geometria", txt: "Ãrea de um triÃ¢ngulo equilÃ¡tero de lado L:", opt: ["LÂ²", "(LÂ²âˆš3)/4", "L.h", "3L"], cor: 1 },
            { id: "MAT-GEO-060", cat: "MatemÃ¡tica", sub: "Geometria", txt: "O vÃ©rtice de um cone fica oposto Ã :", opt: ["Altura", "Geratriz", "Base", "Lateral"], cor: 2 },

            
            
            // --- SUB: ÃLGEBRA ---
            { id: "MAT-ALG-001", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Raiz de 2x - 4 = 0:", opt: ["1", "2", "4", "-2"], cor: 1 },
            { id: "MAT-ALG-002", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Bhaskara resolve equaÃ§Ãµes de:", opt: ["1Âº Grau", "2Âº Grau", "3Âº Grau", "Exponencial"], cor: 1 },
            { id: "MAT-ALG-003", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O prÃ³ximo termo da P.A. (2, 5, 8...) Ã©:", opt: ["10", "11", "12", "13"], cor: 1 },
            { id: "MAT-ALG-004", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Logaritmo de 100 na base 10:", opt: ["1", "2", "10", "100"], cor: 1 },
            { id: "MAT-ALG-005", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se f(x) = 2x + 1, qual o valor de f(3)?", opt: ["5", "6", "7", "8"], cor: 2 },
            { id: "MAT-ALG-006", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual Ã© o valor de 3 fatorial (3!)?", opt: ["3", "6", "9", "1"], cor: 1 },
            { id: "MAT-ALG-007", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O resultado de (a + b)Â² Ã©:", opt: ["aÂ² + bÂ²", "aÂ² - bÂ²", "aÂ² + 2ab + bÂ²", "2a + 2b"], cor: 2 },
            { id: "MAT-ALG-008", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o valor de x em 3x + 1 = x + 11?", opt: ["2", "3", "4", "5"], cor: 3 },
            { id: "MAT-ALG-009", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qualquer nÃºmero elevado a zero Ã© igual a:", opt: ["0", "1", "Ele mesmo", "Infinito"], cor: 1 },
            { id: "MAT-ALG-010", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "A funÃ§Ã£o f(x) = xÂ² representa uma:", opt: ["Reta", "HipÃ©rbole", "ParÃ¡bola", "Elipse"], cor: 2 },
            { id: "MAT-ALG-011", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se x = -2, quanto vale xÂ²?", opt: ["-4", "4", "-2", "0"], cor: 1 },
            { id: "MAT-ALG-012", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O discriminante (Delta) de uma equaÃ§Ã£o de 2Âº grau Ã©:", opt: ["bÂ² - 4ac", "-b / 2a", "c / a", "a + b + c"], cor: 0 },
            { id: "MAT-ALG-013", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Fatorando xÂ² - 9, temos:", opt: ["(x-3)(x-3)", "(x+3)(x-3)", "(x+9)(x-9)", "x(x-9)"], cor: 1 },
            { id: "MAT-ALG-014", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o valor de 2Â³?", opt: ["6", "8", "9", "12"], cor: 1 },
            { id: "MAT-ALG-015", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "InequaÃ§Ã£o: Se -x > 5, entÃ£o:", opt: ["x > 5", "x < 5", "x > -5", "x < -5"], cor: 3 },
            { id: "MAT-ALG-016", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O coeficiente linear da reta y = 3x + 2 Ã©:", opt: ["3", "2", "x", "y"], cor: 1 },
            { id: "MAT-ALG-017", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Resolva o sistema: x+y=10 e x-y=2.", opt: ["x=5, y=5", "x=6, y=4", "x=7, y=3", "x=8, y=2"], cor: 1 },
            { id: "MAT-ALG-018", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O produto (x+1)(x-1) resulta em:", opt: ["xÂ² + 1", "xÂ² - 1", "xÂ² + 2x + 1", "xÂ² - 2x + 1"], cor: 1 },
            { id: "MAT-ALG-019", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o valor de 5â°?", opt: ["0", "1", "5", "Indefinido"], cor: 1 },
            { id: "MAT-ALG-020", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O vÃ©rtice de uma parÃ¡bola y=xÂ² fica em:", opt: ["(0,0)", "(1,1)", "(0,1)", "(1,0)"], cor: 0 },
            { id: "MAT-ALG-021", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se 2x = 1/2, entÃ£o x vale:", opt: ["1", "0,5", "0,25", "2"], cor: 2 },
            { id: "MAT-ALG-022", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "A expressÃ£o bÂ² - 4ac < 0 indica que a equaÃ§Ã£o:", opt: ["Tem 2 raÃ­zes reais", "Tem 1 raiz real", "NÃ£o tem raiz real", "Ã‰ nula"], cor: 2 },
            { id: "MAT-ALG-023", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o valor de x em âˆšx = 9?", opt: ["3", "18", "81", "90"], cor: 2 },
            { id: "MAT-ALG-024", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "A sequÃªncia (2, 4, 8, 16...) Ã© uma:", opt: ["P.A.", "P.G.", "Fatorial", "Constante"], cor: 1 },
            { id: "MAT-ALG-025", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O inverso de 2/3 Ã©:", opt: ["-2/3", "3/2", "1", "0"], cor: 1 },
            { id: "MAT-ALG-026", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Simplifique: (xÂ³)/(xÂ²)", opt: ["x", "xâµ", "1", "xâ»Â¹"], cor: 0 },
            { id: "MAT-ALG-027", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "A equaÃ§Ã£o xÂ² + 1 = 0 tem soluÃ§Ã£o em:", opt: ["Reais", "Inteiros", "Complexos", "Naturais"], cor: 2 },
            { id: "MAT-ALG-028", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Fatore: xÂ² + 2x + 1", opt: ["(x+1)Â²", "(x-1)Â²", "x(x+2)", "(x+2)(x+1)"], cor: 0 },
            { id: "MAT-ALG-029", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se 3x + 5 = 20, x Ã©:", opt: ["3", "4", "5", "6"], cor: 2 },
            { id: "MAT-ALG-030", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o valor de |-5| (mÃ³dulo)?", opt: ["-5", "5", "0", "1"], cor: 1 },
            { id: "MAT-ALG-031", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Logaritmo de 1 em qualquer base Ã©:", opt: ["0", "1", "A base", "Infinito"], cor: 0 },
            { id: "MAT-ALG-032", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O grÃ¡fico de uma funÃ§Ã£o de 1Âº grau Ã© uma:", opt: ["Curva", "Reta", "Onda", "CÃ­rculo"], cor: 1 },
            { id: "MAT-ALG-033", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o M.M.C de 3 e 4?", opt: ["7", "12", "1", "34"], cor: 1 },
            { id: "MAT-ALG-034", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O valor de 4! (fatorial) Ã©:", opt: ["4", "16", "24", "10"], cor: 2 },
            { id: "MAT-ALG-035", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Na equaÃ§Ã£o y = ax + b, 'b' indica:", opt: ["InclinaÃ§Ã£o", "InterseÃ§Ã£o com eixo Y", "Raiz", "VÃ©rtice"], cor: 1 },
            { id: "MAT-ALG-036", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se x/3 = 4, entÃ£o x Ã©:", opt: ["7", "1", "12", "0.75"], cor: 2 },
            { id: "MAT-ALG-037", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual destes Ã© um nÃºmero irracional?", opt: ["2", "0,5", "âˆš2", "1/3"], cor: 2 },
            { id: "MAT-ALG-038", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Desenvolva (x - 2)Â²:", opt: ["xÂ² - 4", "xÂ² - 4x + 4", "xÂ² + 4", "xÂ² - 2x + 4"], cor: 1 },
            { id: "MAT-ALG-039", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se f(x) = xÂ², f(-3) Ã©:", opt: ["-9", "9", "6", "-6"], cor: 1 },
            { id: "MAT-ALG-040", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o valor de 2 elevado a -1?", opt: ["-2", "0", "0.5", "1"], cor: 2 },
            { id: "MAT-ALG-041", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se x + y = 7 e x - y = 1, qual o valor de x?", opt: ["3", "4", "5", "6"], cor: 1 },
            { id: "MAT-ALG-042", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o valor de 3 elevado a 3?", opt: ["6", "9", "27", "81"], cor: 2 },
            { id: "MAT-ALG-043", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "A raiz quadrada de 144 Ã©:", opt: ["10", "11", "12", "14"], cor: 2 },
            { id: "MAT-ALG-044", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O conjunto dos nÃºmeros Z representa os:", opt: ["Naturais", "Inteiros", "Racionais", "Reais"], cor: 1 },
            { id: "MAT-ALG-045", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se 4x = 100, x vale:", opt: ["20", "25", "40", "10"], cor: 1 },
            { id: "MAT-ALG-046", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "A expressÃ£o aÂ² - bÂ² Ã© uma:", opt: ["DiferenÃ§a de quadrados", "Soma de cubos", "TrinÃ´mio perfeito", "FatoraÃ§Ã£o simples"], cor: 0 },
            { id: "MAT-ALG-047", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o MDC de 10 e 20?", opt: ["2", "5", "10", "20"], cor: 2 },
            { id: "MAT-ALG-048", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se logâ‚‚ x = 3, entÃ£o x Ã©:", opt: ["6", "8", "9", "5"], cor: 1 },
            { id: "MAT-ALG-049", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O grÃ¡fico de f(x) = 2 Ã© uma reta:", opt: ["Crescente", "Decrescente", "Horizontal", "Vertical"], cor: 2 },
            { id: "MAT-ALG-050", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual a soma das raÃ­zes de xÂ² - 5x + 6 = 0?", opt: ["-5", "5", "6", "-6"], cor: 1 },
            { id: "MAT-ALG-051", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o produto das raÃ­zes de xÂ² - 5x + 6 = 0?", opt: ["5", "-5", "6", "-6"], cor: 2 },
            { id: "MAT-ALG-052", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "A notaÃ§Ã£o 5! significa:", opt: ["5+4+3+2+1", "5x4x3x2x1", "5^5", "5x5"], cor: 1 },
            { id: "MAT-ALG-053", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Em uma PA de razÃ£o 2, se a1=10, a2 Ã©:", opt: ["8", "11", "12", "20"], cor: 2 },
            { id: "MAT-ALG-054", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Em uma PG de razÃ£o 3, se a1=2, a2 Ã©:", opt: ["5", "6", "8", "9"], cor: 1 },
            { id: "MAT-ALG-055", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual o valor de 100â° + 10Â¹?", opt: ["10", "11", "20", "101"], cor: 1 },
            { id: "MAT-ALG-056", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O determinante da matriz identidade Ã©:", opt: ["0", "1", "-1", "Varia"], cor: 1 },
            { id: "MAT-ALG-057", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "A desigualdade |x| < 3 significa:", opt: ["x < 3", "x > -3", "-3 < x < 3", "x > 3"], cor: 2 },
            { id: "MAT-ALG-058", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "O nÃºmero 'Pi' (Ï€) Ã©:", opt: ["Racional", "Inteiro", "Irracional", "ImaginÃ¡rio"], cor: 2 },
            { id: "MAT-ALG-059", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Se f(x) = 3x - 1, a raiz Ã©:", opt: ["1", "3", "1/3", "-1/3"], cor: 2 },
            { id: "MAT-ALG-060", cat: "MatemÃ¡tica", sub: "Ãlgebra", txt: "Qual a representaÃ§Ã£o de 'i' nos complexos?", opt: ["âˆš-1", "-1", "1", "âˆš1"], cor: 0 },

            
            // --- SUB: ESTATÃSTICA ---
            { id: "MAT-EST-001", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "A mÃ©dia de 4, 6 e 8 Ã©:", opt: ["5", "6", "7", "8"], cor: 1 },
            { id: "MAT-EST-002", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "A probabilidade de tirar 'Cara' numa moeda justa:", opt: ["25%", "50%", "75%", "100%"], cor: 1 },
            { id: "MAT-EST-003", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "O valor que mais se repete em um conjunto Ã© a:", opt: ["MÃ©dia", "Mediana", "Moda", "VariÃ¢ncia"], cor: 2 },
            { id: "MAT-EST-004", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Ao lanÃ§ar um dado, chance de sair nÃºmero 7:", opt: ["0%", "16%", "50%", "100%"], cor: 0 },
            { id: "MAT-EST-005", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "A mediana do conjunto {2, 5, 8, 10, 12} Ã©:", opt: ["5", "8", "10", "7.5"], cor: 1 },
            { id: "MAT-EST-006", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Num grÃ¡fico de setores, o cÃ­rculo completo vale:", opt: ["90Â°", "100%", "360Â°", "180Â°"], cor: 2 },
            { id: "MAT-EST-007", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "MÃ©dia Ponderada leva em conta:", opt: ["Apenas a soma", "Os pesos dos valores", "O maior valor", "O menor valor"], cor: 1 },
            { id: "MAT-EST-008", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Amplitude de um conjunto Ã© a diferenÃ§a entre:", opt: ["MÃ©dia e Moda", "Maior e Menor valor", "Primeiro e Ãšltimo", "Positivos e Negativos"], cor: 1 },
            { id: "MAT-EST-009", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Probabilidade de sair nÃºmero par num dado de 6 lados:", opt: ["1/6", "1/2", "1/3", "2/3"], cor: 1 },
            { id: "MAT-EST-010", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Se a frequÃªncia de um evento Ã© 100%, ele Ã©:", opt: ["ImpossÃ­vel", "ProvÃ¡vel", "Certo", "AleatÃ³rio"], cor: 2 },
            { id: "MAT-EST-011", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Num dado viciado, se o 6 sai 50% das vezes, a probabilidade Ã©:", opt: ["1/6", "1/2", "1/3", "1/5"], cor: 1 },
            { id: "MAT-EST-012", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Para calcular a mÃ©dia aritmÃ©tica:", opt: ["Multiplica e divide", "Soma tudo e divide pela quantidade", "Pega o valor do meio", "Subtrai o menor do maior"], cor: 1 },
            { id: "MAT-EST-013", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "A chance de tirar 'coroa' em 2 moedas seguidas:", opt: ["50%", "25%", "10%", "100%"], cor: 1 },
            { id: "MAT-EST-014", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "O desvio padrÃ£o mede:", opt: ["A mÃ©dia", "O centro", "A dispersÃ£o dos dados", "A soma"], cor: 2 },
            { id: "MAT-EST-015", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Qual grÃ¡fico usa 'fatias'?", opt: ["Barras", "Linhas", "Setores (Pizza)", "DispersÃ£o"], cor: 2 },
            { id: "MAT-EST-016", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Uma amostra representa:", opt: ["Toda a populaÃ§Ã£o", "Uma parte da populaÃ§Ã£o", "Um erro de cÃ¡lculo", "O censo"], cor: 1 },
            { id: "MAT-EST-017", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Se a mÃ©dia Ã© 5 e a soma Ã© 20, quantos elementos tÃªm?", opt: ["4", "5", "10", "15"], cor: 0 },
            { id: "MAT-EST-018", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Em probabilidade, o evento 'impossÃ­vel' vale:", opt: ["1", "0,5", "0", "-1"], cor: 2 },
            { id: "MAT-EST-019", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Histograma Ã© um grÃ¡fico de:", opt: ["Barras coladas", "Linhas curvas", "Pontos", "Pizza"], cor: 0 },
            { id: "MAT-EST-020", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Moda do conjunto {1, 2, 2, 3, 4}:", opt: ["1", "2", "3", "4"], cor: 1 },
            { id: "MAT-EST-021", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "A soma das probabilidades de todos eventos possÃ­veis Ã©:", opt: ["0", "0,5", "1", "100"], cor: 2 },
            { id: "MAT-EST-022", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Qual a chance de tirar um Ãs num baralho de 52 cartas?", opt: ["1/13", "1/52", "4/13", "1/2"], cor: 0 },
            { id: "MAT-EST-023", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "VariÃ¡vel 'Cor dos olhos' Ã©:", opt: ["Quantitativa", "Qualitativa", "NumÃ©rica", "Discreta"], cor: 1 },
            { id: "MAT-EST-024", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "VariÃ¡vel 'Altura' Ã©:", opt: ["Qualitativa", "Quantitativa ContÃ­nua", "Discreta", "Nominal"], cor: 1 },
            { id: "MAT-EST-025", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "O Rol Ã©:", opt: ["Dados organizados em ordem", "Dados bagunÃ§ados", "A mÃ©dia", "O grÃ¡fico"], cor: 0 },
            { id: "MAT-EST-026", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "A VariÃ¢ncia Ã© o quadrado do:", opt: ["Desvio PadrÃ£o", "Erro Amostral", "Coeficiente", "Moda"], cor: 0 },
            { id: "MAT-EST-027", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Qual a probabilidade de tirar soma 2 em dois dados?", opt: ["1/36", "1/6", "1/12", "1/18"], cor: 0 },
            { id: "MAT-EST-028", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Numa urna com 3 bolas azuis e 2 vermelhas, chance de tirar azul:", opt: ["20%", "40%", "60%", "30%"], cor: 2 },
            { id: "MAT-EST-029", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Se a mÃ©dia das notas Ã© 7 e o aluno tirou 5 e 9, a terceira nota foi:", opt: ["6", "7", "8", "9"], cor: 1 },
            { id: "MAT-EST-030", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "O censo do IBGE Ã© uma pesquisa:", opt: ["Amostral", "CensitÃ¡ria", "Parcial", "AleatÃ³ria"], cor: 1 },
            { id: "MAT-EST-031", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "A frequÃªncia relativa Ã© dada em:", opt: ["NÃºmeros absolutos", "Porcentagem", "Graus", "Metros"], cor: 1 },
            { id: "MAT-EST-032", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Dados 'Outliers' sÃ£o:", opt: ["Valores mÃ©dios", "Valores muito distantes do padrÃ£o", "Erros de digitaÃ§Ã£o", "A moda"], cor: 1 },
            { id: "MAT-EST-033", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Para calcular a mediana de dados pares, fazemos:", opt: ["MÃ©dia dos dois centrais", "Soma tudo", "Pega o maior", "Pega o menor"], cor: 0 },
            { id: "MAT-EST-034", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Probabilidade de um evento A OU B ocorrer (uniÃ£o):", opt: ["P(A) + P(B)", "P(A) x P(B)", "P(A) - P(B)", "P(A)/P(B)"], cor: 0 },
            { id: "MAT-EST-035", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Probabilidade de A E B (independentes):", opt: ["P(A) + P(B)", "P(A) x P(B)", "P(A) - P(B)", "P(A)/P(B)"], cor: 1 },
            { id: "MAT-EST-036", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Em um grÃ¡fico de barras, a altura indica:", opt: ["A frequÃªncia", "O tempo", "A mÃ©dia", "A variÃ¢ncia"], cor: 0 },
            { id: "MAT-EST-037", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Qual medida separa os 50% menores dos 50% maiores?", opt: ["MÃ©dia", "Moda", "Mediana", "Desvio"], cor: 2 },
            { id: "MAT-EST-038", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Numa amostra viciada, os dados sÃ£o:", opt: ["ConfiÃ¡veis", "Tendenciosos", "AleatÃ³rios", "Representativos"], cor: 1 },
            { id: "MAT-EST-039", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "A soma das frequÃªncias relativas deve dar:", opt: ["100", "1", "0", "Varia"], cor: 1 },
            { id: "MAT-EST-040", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Se a probabilidade de chover Ã© 30%, a de NÃƒO chover Ã©:", opt: ["30%", "50%", "70%", "100%"], cor: 2 },
            { id: "MAT-EST-041", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "O espaÃ§o amostral de uma moeda Ã©:", opt: ["{Cara}", "{Coroa}", "{Cara, Coroa}", "{1, 2}"], cor: 2 },
            { id: "MAT-EST-042", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "MÃ©dia aritmÃ©tica de {10, 10, 10}:", opt: ["10", "30", "1", "0"], cor: 0 },
            { id: "MAT-EST-043", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "PopulaÃ§Ã£o em estatÃ­stica significa:", opt: ["Pessoas de um paÃ­s", "Conjunto total de elementos pesquisados", "Amostra pequena", "Censo"], cor: 1 },
            { id: "MAT-EST-044", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "Probabilidade varia entre:", opt: ["-1 e 1", "0 e 1", "0 e 100", "1 e 100"], cor: 1 },
            { id: "MAT-EST-045", cat: "MatemÃ¡tica", sub: "EstatÃ­stica", txt: "O grÃ¡fico de dispersÃ£o analisa:", opt: ["EvoluÃ§Ã£o no tempo", "RelaÃ§Ã£o entre duas variÃ¡veis", "Partes de um todo", "Hierarquia"], cor: 1 },
            
            // --- NOVO TÃ“PICO: MATEMÃTICA FINANCEIRA (001 em diante) ---
            { id: "MAT-FIN-001", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Juros compostos sÃ£o conhecidos como:", opt: ["Juros sobre juros", "Juros fixos", "Desconto simples", "AmortizaÃ§Ã£o"], cor: 0 },
            { id: "MAT-FIN-002", cat: "MatemÃ¡tica", sub: "Financeira", txt: "50% de 50% Ã© igual a:", opt: ["100%", "50%", "25%", "10%"], cor: 2 },
            { id: "MAT-FIN-003", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Um aumento de 10% seguido de outro de 10% resulta em:", opt: ["20%", "21%", "100%", "121%"], cor: 1 },
            { id: "MAT-FIN-004", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Montante Ã© igual a:", opt: ["Capital - Juros", "Capital + Juros", "Juros / Tempo", "Capital x Taxa"], cor: 1 },
            { id: "MAT-FIN-005", cat: "MatemÃ¡tica", sub: "Financeira", txt: "A taxa Selic influencia principalmente:", opt: ["O clima", "A inflaÃ§Ã£o e juros", "O PIB per capita", "A demografia"], cor: 1 },
            { id: "MAT-FIN-006", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Se comprei por 100 e vendi por 150, o lucro foi de:", opt: ["30%", "40%", "50%", "100%"], cor: 2 },
            { id: "MAT-FIN-007", cat: "MatemÃ¡tica", sub: "Financeira", txt: "O que Ã© 'Capital' em matemÃ¡tica financeira?", opt: ["Lucro total", "Valor inicial investido", "Tempo de aplicaÃ§Ã£o", "Taxa de juros"], cor: 1 },
            { id: "MAT-FIN-008", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Para transformar 20% em decimal, dividimos por:", opt: ["10", "100", "1000", "1"], cor: 1 },
            { id: "MAT-FIN-009", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Se a inflaÃ§Ã£o Ã© 10%, o poder de compra:", opt: ["Aumenta", "Diminui", "Fica igual", "Dobra"], cor: 1 },
            { id: "MAT-FIN-010", cat: "MatemÃ¡tica", sub: "Financeira", txt: "1/4 em porcentagem Ã©:", opt: ["20%", "25%", "40%", "50%"], cor: 1 },
            { id: "MAT-FIN-011", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Lucro LÃ­quido Ã©:", opt: ["Receita Total", "Receita - Despesas", "Apenas as despesas", "O valor do imposto"], cor: 1 },
            { id: "MAT-FIN-012", cat: "MatemÃ¡tica", sub: "Financeira", txt: "O que Ã© 'AmortizaÃ§Ã£o'?", opt: ["Pagar juros", "Reduzir a dÃ­vida original", "Aumentar o prazo", "Pegar emprÃ©stimo"], cor: 1 },
            { id: "MAT-FIN-013", cat: "MatemÃ¡tica", sub: "Financeira", txt: "30% de 300 Ã©:", opt: ["30", "60", "90", "100"], cor: 2 },
            { id: "MAT-FIN-014", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Se ganhei 10% e perdi 10% sobre o novo valor:", opt: ["Fiquei igual", "Perdi dinheiro", "Ganhei dinheiro", "ImpossÃ­vel saber"], cor: 1 },
            { id: "MAT-FIN-015", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Fator de aumento de 20% Ã© multiplicar por:", opt: ["0,2", "1,2", "2,0", "120"], cor: 1 },
            { id: "MAT-FIN-016", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Fator de desconto de 30% Ã© multiplicar por:", opt: ["0,3", "1,3", "0,7", "3,0"], cor: 2 },
            { id: "MAT-FIN-017", cat: "MatemÃ¡tica", sub: "Financeira", txt: "O que Ã© superÃ¡vit?", opt: ["Gastar mais que ganha", "Ganhar mais que gasta", "Empatar", "DÃ­vida"], cor: 1 },
            { id: "MAT-FIN-018", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Juros de 1% ao mÃªs em juros simples, apÃ³s 12 meses:", opt: ["12%", "Mais que 12%", "Menos que 12%", "1%"], cor: 0 },
            { id: "MAT-FIN-019", cat: "MatemÃ¡tica", sub: "Financeira", txt: "PIB significa:", opt: ["Produto Interno Bruto", "PreÃ§o Interno Base", "Plano Internacional BancÃ¡rio", "Pagamento Imposto Bruto"], cor: 0 },
            { id: "MAT-FIN-020", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Se o dÃ³lar sobe, as importaÃ§Ãµes ficam:", opt: ["Mais baratas", "Mais caras", "Iguais", "Isentas"], cor: 1 },
            { id: "MAT-FIN-021", cat: "MatemÃ¡tica", sub: "Financeira", txt: "A fÃ³rmula M = C(1+i)^t Ã© de:", opt: ["Juros Simples", "Juros Compostos", "AmortizaÃ§Ã£o", "Desconto"], cor: 1 },
            { id: "MAT-FIN-022", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Se o preÃ§o triplicou, o aumento foi de:", opt: ["100%", "200%", "300%", "50%"], cor: 1 },
            { id: "MAT-FIN-023", cat: "MatemÃ¡tica", sub: "Financeira", txt: "O que Ã© IOF?", opt: ["Imposto sobre OperaÃ§Ãµes Financeiras", "Ãndice Oficial Financeiro", "Imposto ObrigatÃ³rio Federal", "InstituiÃ§Ã£o de Oferta"], cor: 0 },
            { id: "MAT-FIN-024", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Qual o juro simples de R$100 a 10% por 2 meses?", opt: ["R$ 10", "R$ 20", "R$ 21", "R$ 12"], cor: 1 },
            { id: "MAT-FIN-025", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Qual o juro composto de R$100 a 10% por 2 meses?", opt: ["R$ 20", "R$ 21", "R$ 22", "R$ 121"], cor: 1 },
            { id: "MAT-FIN-026", cat: "MatemÃ¡tica", sub: "Financeira", txt: "DeflaÃ§Ã£o Ã©:", opt: ["Aumento de preÃ§os", "Queda generalizada de preÃ§os", "Estabilidade", "Aumento do PIB"], cor: 1 },
            { id: "MAT-FIN-027", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Spread bancÃ¡rio Ã©:", opt: ["Lucro do banco", "PrejuÃ­zo do banco", "DiferenÃ§a entre juros captados e cobrados", "Taxa do governo"], cor: 2 },
            { id: "MAT-FIN-028", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Liquidez significa:", opt: ["Ter muita Ã¡gua", "Facilidade de transformar ativo em dinheiro", "DÃ­vida alta", "Lucro baixo"], cor: 1 },
            { id: "MAT-FIN-029", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Um boleto vencido geralmente cobra:", opt: ["Multa e Juros", "Desconto", "Apenas o original", "Taxa administrativa"], cor: 0 },
            { id: "MAT-FIN-030", cat: "MatemÃ¡tica", sub: "Financeira", txt: "CÃ¢mbio flutuante significa:", opt: ["Governo fixa o valor", "O mercado define o valor", "Valor nunca muda", "Valor muda uma vez por ano"], cor: 1 },
            { id: "MAT-FIN-031", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Para triplicar um capital a juros simples de 100% a.a., leva:", opt: ["1 ano", "2 anos", "3 anos", "4 anos"], cor: 1 },
            { id: "MAT-FIN-032", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Renda Fixa Ã© considerada:", opt: ["Alto risco", "Baixo risco", "Sem retorno", "Ilegal"], cor: 1 },
            { id: "MAT-FIN-033", cat: "MatemÃ¡tica", sub: "Financeira", txt: "A Bolsa de Valores brasileira Ã© a:", opt: ["NASDAQ", "B3", "Dow Jones", "Nikkei"], cor: 1 },
            { id: "MAT-FIN-034", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Dividendo Ã©:", opt: ["DÃ­vida da empresa", "Parte do lucro pago ao acionista", "Imposto", "Multa"], cor: 1 },
            { id: "MAT-FIN-035", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Se gastei 2/5 do salÃ¡rio, sobrou:", opt: ["20%", "40%", "60%", "80%"], cor: 2 },
            { id: "MAT-FIN-036", cat: "MatemÃ¡tica", sub: "Financeira", txt: "O 'nome sujo' fica registrado no:", opt: ["SPC/Serasa", "IBGE", "MEC", "SUS"], cor: 0 },
            { id: "MAT-FIN-037", cat: "MatemÃ¡tica", sub: "Financeira", txt: "CartÃ£o de crÃ©dito cobra juros se:", opt: ["Pagar a fatura total", "Pagar o mÃ­nimo ou atrasar", "Nunca usar", "Usar no dÃ©bito"], cor: 1 },
            { id: "MAT-FIN-038", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Um trimestre tem:", opt: ["2 meses", "3 meses", "4 meses", "6 meses"], cor: 1 },
            { id: "MAT-FIN-039", cat: "MatemÃ¡tica", sub: "Financeira", txt: "O salÃ¡rio mÃ­nimo Ã© reajustado com base na:", opt: ["InflaÃ§Ã£o", "DÃ³lar", "Bolsa", "Vontade do patrÃ£o"], cor: 0 },
            { id: "MAT-FIN-040", cat: "MatemÃ¡tica", sub: "Financeira", txt: "Desconto Ã  vista serve para:", opt: ["Pagar mais caro", "Evitar taxas de cartÃ£o/prazo", "Parcelar", "Aumentar juros"], cor: 1 },

            
            
            // ================= NATUREZA =================

            // --- SUB: BIOLOGIA ---
            { id: "NAT-BIO-001", cat: "Natureza", sub: "Biologia", txt: "Usina de energia da cÃ©lula:", opt: ["MitocÃ´ndria", "NÃºcleo", "Ribossomo", "VacÃºolo"], cor: 0 },
            { id: "NAT-BIO-002", cat: "Natureza", sub: "Biologia", txt: "VÃ­rus sÃ£o seres:", opt: ["Eucariontes", "Procariontes", "Acelulares", "Vegetais"], cor: 2 },
            { id: "NAT-BIO-003", cat: "Natureza", sub: "Biologia", txt: "Base nitrogenada exclusiva do RNA:", opt: ["Timina", "Uracila", "Citosina", "Guanina"], cor: 1 },
            { id: "NAT-BIO-004", cat: "Natureza", sub: "Biologia", txt: "RelaÃ§Ã£o ecolÃ³gica onde ambos se beneficiam:", opt: ["Parasitismo", "CompetiÃ§Ã£o", "Mutualismo", "Amensalismo"], cor: 2 },
            { id: "NAT-BIO-005", cat: "Natureza", sub: "Biologia", txt: "O sangue tipo O Ã© conhecido como:", opt: ["Receptor Universal", "Doador Universal", "Neutro", "Positivo"], cor: 1 },
            { id: "NAT-BIO-006", cat: "Natureza", sub: "Biologia", txt: "Processo que plantas usam para criar energia:", opt: ["RespiraÃ§Ã£o", "FotossÃ­ntese", "FermentaÃ§Ã£o", "OxidaÃ§Ã£o"], cor: 1 },

            // --- SUB: FÃSICA ---
            { id: "NAT-FIS-001", cat: "Natureza", sub: "FÃ­sica", txt: "A unidade de ForÃ§a no SI Ã©:", opt: ["Joule", "Watt", "Newton", "Pascal"], cor: 2 },
            { id: "NAT-FIS-002", cat: "Natureza", sub: "FÃ­sica", txt: "Velocidade Ã© a razÃ£o entre:", opt: ["DistÃ¢ncia e Tempo", "Massa e AceleraÃ§Ã£o", "ForÃ§a e Ãrea", "Energia e Tempo"], cor: 0 },
            { id: "NAT-FIS-003", cat: "Natureza", sub: "FÃ­sica", txt: "Qual lei diz 'AÃ§Ã£o e ReaÃ§Ã£o'?", opt: ["1Âª Lei de Newton", "2Âª Lei de Newton", "3Âª Lei de Newton", "Lei de Ohm"], cor: 2 },
            { id: "NAT-FIS-004", cat: "Natureza", sub: "FÃ­sica", txt: "V = R.i Ã© a fÃ³rmula de:", opt: ["PotÃªncia", "1Âª Lei de Ohm", "Velocidade", "Calorimetria"], cor: 1 },
            { id: "NAT-FIS-005", cat: "Natureza", sub: "FÃ­sica", txt: "A gravidade na Terra Ã© aproximadamente:", opt: ["5 m/sÂ²", "9,8 m/sÂ²", "15 m/sÂ²", "20 m/sÂ²"], cor: 1 },

            // --- SUB: QUÃMICA ---
            { id: "NAT-QUI-001", cat: "Natureza", sub: "QuÃ­mica", txt: "O pH 7 Ã© considerado:", opt: ["Ãcido", "BÃ¡sico", "Neutro", "Salino"], cor: 2 },
            { id: "NAT-QUI-002", cat: "Natureza", sub: "QuÃ­mica", txt: "Elemento quÃ­mico 'Au':", opt: ["Prata", "Ouro", "Cobre", "AlumÃ­nio"], cor: 1 },
            { id: "NAT-QUI-003", cat: "Natureza", sub: "QuÃ­mica", txt: "LigaÃ§Ã£o onde hÃ¡ compartilhamento de elÃ©trons:", opt: ["IÃ´nica", "Covalente", "MetÃ¡lica", "HidrogÃªnio"], cor: 1 },
            { id: "NAT-QUI-004", cat: "Natureza", sub: "QuÃ­mica", txt: "Principal gÃ¡s do Efeito Estufa:", opt: ["OxigÃªnio", "NitrogÃªnio", "DiÃ³xido de Carbono", "HÃ©lio"], cor: 2 },
            { id: "NAT-QUI-005", cat: "Natureza", sub: "QuÃ­mica", txt: "Mistura Ãgua + Ã“leo Ã©:", opt: ["HomogÃªnea", "HeterogÃªnea", "SolÃºvel", "Coloidal"], cor: 1 },

            // ================= HUMANAS =================

            // --- SUB: HISTÃ“RIA ---
            { id: "HUM-HIS-001", cat: "Humanas", sub: "HistÃ³ria", txt: "Quem descobriu o Brasil?", opt: ["Cabral", "Colombo", "Vasco da Gama", "Pero Vaz"], cor: 0 },
            { id: "HUM-HIS-002", cat: "Humanas", sub: "HistÃ³ria", txt: "Era Vargas durou de:", opt: ["1930-1945", "1964-1985", "1889-1930", "1500-1822"], cor: 0 },
            { id: "HUM-HIS-003", cat: "Humanas", sub: "HistÃ³ria", txt: "A Lei Ãurea aboliu:", opt: ["A Monarquia", "A EscravidÃ£o", "O Imposto", "A Guerra"], cor: 1 },
            { id: "HUM-HIS-004", cat: "Humanas", sub: "HistÃ³ria", txt: "Ditadura Militar no Brasil iniciou em:", opt: ["1945", "1950", "1964", "1985"], cor: 2 },
            { id: "HUM-HIS-005", cat: "Humanas", sub: "HistÃ³ria", txt: "RevoluÃ§Ã£o que decapitou LuÃ­s XVI:", opt: ["Industrial", "Francesa", "Russa", "Americana"], cor: 1 },

            // --- SUB: GEOGRAFIA ---
            { id: "HUM-GEO-001", cat: "Humanas", sub: "Geografia", txt: "Maior floresta tropical do mundo:", opt: ["Congo", "AmazÃ´nia", "Taiga", "Mata AtlÃ¢ntica"], cor: 1 },
            { id: "HUM-GEO-002", cat: "Humanas", sub: "Geografia", txt: "Capital dos Estados Unidos:", opt: ["New York", "Los Angeles", "Washington D.C.", "Miami"], cor: 2 },
            { id: "HUM-GEO-003", cat: "Humanas", sub: "Geografia", txt: "Movimento de placas tectÃ´nicas causa:", opt: ["FuracÃµes", "Terremotos", "Secas", "Chuvas"], cor: 1 },
            { id: "HUM-GEO-004", cat: "Humanas", sub: "Geografia", txt: "Setor da economia ligado Ã  agricultura:", opt: ["PrimÃ¡rio", "SecundÃ¡rio", "TerciÃ¡rio", "QuaternÃ¡rio"], cor: 0 },
            { id: "HUM-GEO-005", cat: "Humanas", sub: "Geografia", txt: "PaÃ­s mais populoso do mundo (2023):", opt: ["EUA", "Brasil", "Ãndia", "RÃºssia"], cor: 2 },

            // --- SUB: FILOSOFIA/SOCIOLOGIA ---
            { id: "HUM-FIL-001", cat: "Humanas", sub: "Filosofia", txt: "Autor de 'O PrÃ­ncipe':", opt: ["Maquiavel", "Hobbes", "Rousseau", "Kant"], cor: 0 },
            { id: "HUM-FIL-002", cat: "Humanas", sub: "Filosofia", txt: "'Penso, logo existo' Ã© de:", opt: ["SÃ³crates", "Descartes", "Nietzsche", "PlatÃ£o"], cor: 1 },
            { id: "HUM-SOC-001", cat: "Humanas", sub: "Sociologia", txt: "Conceito de 'Fato Social' Ã© de:", opt: ["Weber", "Durkheim", "Marx", "Comte"], cor: 1 },

            // ================= LINGUAGENS =================

            // --- SUB: GRAMÃTICA ---
            { id: "LIN-GRA-001", cat: "Linguagens", sub: "GramÃ¡tica", txt: "AntÃ´nimo de 'efÃªmero':", opt: ["RÃ¡pido", "Passageiro", "Duradouro", "Breve"], cor: 2 },
            { id: "LIN-GRA-002", cat: "Linguagens", sub: "GramÃ¡tica", txt: "Qual palavra tem hÃ­fen corretamente?", opt: ["Anti-social", "Micro-ondas", "Auto-escola", "Dia-a-dia"], cor: 1 },
            { id: "LIN-GRA-003", cat: "Linguagens", sub: "GramÃ¡tica", txt: "Em 'Fui Ã  praia', a crase indica:", opt: ["PreposiÃ§Ã£o + Artigo", "Apenas artigo", "Verbo", "AdvÃ©rbio"], cor: 0 },
            { id: "LIN-GRA-004", cat: "Linguagens", sub: "GramÃ¡tica", txt: "Qual Ã© o sujeito de: 'Choveu muito'?", opt: ["Simples", "Oculto", "Inexistente", "Composto"], cor: 2 },

            // --- SUB: LITERATURA ---
            { id: "LIN-LIT-001", cat: "Linguagens", sub: "Literatura", txt: "Autor de 'Vidas Secas':", opt: ["Jorge Amado", "Graciliano Ramos", "GuimarÃ£es Rosa", "Clarice"], cor: 1 },
            { id: "LIN-LIT-002", cat: "Linguagens", sub: "Literatura", txt: "Movimento literÃ¡rio de GregÃ³rio de Matos:", opt: ["Barroco", "Arcadismo", "Romantismo", "Realismo"], cor: 0 },
            { id: "LIN-LIT-003", cat: "Linguagens", sub: "Literatura", txt: "Capitu Ã© personagem de qual obra?", opt: ["MemÃ³rias PÃ³stumas", "Dom Casmurro", "Quincas Borba", "O CortiÃ§o"], cor: 1 },

            // --- SUB: ARTES/INGLÃŠS/ESPANHOL ---
            { id: "LIN-ART-001", cat: "Linguagens", sub: "Artes", txt: "Picasso Ã© o Ã­cone do:", opt: ["Surrealismo", "Cubismo", "Impressionismo", "DadaÃ­smo"], cor: 1 },
            { id: "LIN-ING-001", cat: "Linguagens", sub: "InglÃªs", txt: "O passado de 'Go' Ã©:", opt: ["Goed", "Gone", "Went", "Going"], cor: 2 },
            { id: "LIN-ESP-001", cat: "Linguagens", sub: "Espanhol", txt: "'Apellido' em espanhol significa:", opt: ["Apelido", "Sobrenome", "Nome", "Rua"], cor: 1 }
        ];


        // --- 3. ESTADO ---
        let doneQuestions = new Set();
        let quizPool = [];
        let currentIndex = 0;
        let score = 0;
        let currentCategory = "";
        let sessionAnsweredIDs = [];

        // --- 4. INICIALIZAÃ‡ÃƒO (FETCH DO BACKEND) ---
        window.onload = async function() {
            try {
                // Chama a API para pegar os IDs jÃ¡ feitos
                const response = await fetch(`${API_BASE}/progresso/${userId}`);
                
                if(!response.ok) throw new Error("Erro na API");
                
                const data = await response.json();
                
                // Popula o Set com os IDs que vieram do banco
                data.ids.forEach(id => doneQuestions.add(id));
                
                const totalFeitas = doneQuestions.size;
                const totalDisponivel = database.length;
                document.getElementById('progressoTotal').innerText = `VocÃª jÃ¡ dominou ${totalFeitas} de ${totalDisponivel} questÃµes!`;

            } catch (err) {
                console.error("Erro ao sincronizar:", err);
                document.getElementById('progressoTotal').innerText = "Modo Offline (Progresso nÃ£o sincronizado)";
            } finally {
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('menuScreen').style.display = 'block';
                checkAutoStart();
            }
        };

        // --- 5. UI LÃ“GICA ---
        function openSubMenu(category) {
            currentCategory = category;
            const catQuestions = database.filter(q => q.cat === category);
            const subTopics = [...new Set(catQuestions.map(q => q.sub))];

            document.getElementById('selectionTitle').innerText = category;
            const container = document.getElementById('topicsContainer');
            container.innerHTML = '';

            if (subTopics.length === 0) return alert("Em breve!");

            subTopics.forEach(topic => {
                const totalTopic = catQuestions.filter(q => q.sub === topic).length;
                const feitasTopic = catQuestions.filter(q => q.sub === topic && doneQuestions.has(q.id)).length;
                const disponiveis = totalTopic - feitasTopic;

                const wrapper = document.createElement('div');
                const disabled = disponiveis === 0 ? 'disabled' : '';
                const labelText = disponiveis === 0 ? `${topic} (Zerado âœ…)` : `${topic} (${disponiveis})`;

                wrapper.innerHTML = `
                    <input type="checkbox" id="check_${topic}" value="${topic}" class="topic-checkbox" ${disabled ? '' : 'checked'} ${disabled}>
                    <label for="check_${topic}" class="topic-label" style="${disabled ? 'opacity:0.5' : ''}">
                        ${labelText}
                    </label>
                `;
                container.appendChild(wrapper);
            });

            document.getElementById('menuScreen').style.display = 'none';
            document.getElementById('selectionScreen').style.display = 'block';
        }

        function confirmStart() {
            const checkedBoxes = document.querySelectorAll('.topic-checkbox:checked');
            const selectedTopics = Array.from(checkedBoxes).map(cb => cb.value);

            if (selectedTopics.length === 0) return alert("Selecione um tÃ³pico ou vocÃª jÃ¡ zerou tudo!");

            quizPool = database.filter(q => 
                q.cat === currentCategory && 
                selectedTopics.includes(q.sub) && 
                !doneQuestions.has(q.id)
            );

            quizPool = quizPool.sort(() => 0.5 - Math.random()).slice(0, 5);

            if (quizPool.length === 0) return alert("VocÃª jÃ¡ completou todas as questÃµes desses tÃ³picos! ParabÃ©ns!");

            startQuizEngine(selectedTopics.join(', '));
        }

        function startQuizGlobal() {
            quizPool = database.filter(q => !doneQuestions.has(q.id));
            quizPool = quizPool.sort(() => 0.5 - Math.random()).slice(0, 10);
            if (quizPool.length === 0) return alert("VocÃª zerou o banco de dados inteiro! Uau!");
            startQuizEngine("Modo AleatÃ³rio");
        }

        function startQuizEngine(label) {
            document.getElementById('selectionScreen').style.display = 'none';
            document.getElementById('menuScreen').style.display = 'none';
            document.getElementById('quizScreen').style.display = 'block';

            currentIndex = 0;
            score = 0;
            sessionAnsweredIDs = [];
            document.getElementById('subjectTag').innerText = label.length > 20 ? label.substring(0, 15) + "..." : label;
            document.getElementById('qTotal').innerText = quizPool.length;
            
            loadQuestion();
        }

        // --- 6. QUIZ ---
        function loadQuestion() {
            const q = quizPool[currentIndex];
            document.getElementById('qIndex').innerText = currentIndex + 1;
            document.getElementById('questionText').innerText = q.txt;
            
            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';

            q.opt.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(index, q.cor, btn, q.id);
                container.appendChild(btn);
            });
        }

        function checkAnswer(selected, correct, btn, questionID) {
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true);

            sessionAnsweredIDs.push(questionID);

            if (selected === correct) {
                btn.classList.add('correct');
                score++;
            } else {
                btn.classList.add('wrong');
                allBtns[correct].classList.add('correct');
            }

            setTimeout(() => {
                currentIndex++;
                if (currentIndex < quizPool.length) loadQuestion();
                else finishQuiz();
            }, 1500);
        }

        // --- 7. FINALIZAR (FETCH POST) ---
        async function finishQuiz() {
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'block';
            document.getElementById('finalScore').innerText = `${score}/${quizPool.length}`;
            document.getElementById('feedbackText').innerText = "Salvando na nuvem...";

            if (sessionAnsweredIDs.length > 0) {
                try {
                    // Manda para o Backend salvar
                    const response = await fetch(`${API_BASE}/concluir`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            userId: userId,
                            questionIds: sessionAnsweredIDs
                        })
                    });

                    if(!response.ok) throw new Error("Erro ao salvar");

                    // Atualiza local
                    sessionAnsweredIDs.forEach(id => doneQuestions.add(id));
                    document.getElementById('feedbackText').innerText = "Progresso salvo! QuestÃµes nÃ£o se repetirÃ£o.";

                } catch (e) {
                    console.error(e);
                    document.getElementById('feedbackText').innerText = "Erro ao salvar (Tente novamente).";
                }
            }
        }

        function backToMenu() {
            document.getElementById('selectionScreen').style.display = 'none';
            document.getElementById('menuScreen').style.display = 'block';
        }

        function checkAutoStart() {
            const auto = localStorage.getItem('simulado_auto_start');
            if (auto) {
                localStorage.removeItem('simulado_auto_start');
                const map = { 'mat': 'MatemÃ¡tica', 'red': 'Linguagens', 'nat': 'Natureza', 'hum': 'Humanas' };
                const cat = map[auto];
                if(cat) openSubMenu(cat);
            }
        }
    </script>
</body>
</html>
