<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulados - Estuda.IA</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4F46E5">
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

    <nav>
        <div class="logo">âœ¨ Estuda.IA</div>
        <a href="index.html" class="btn-outline" style="border:none; font-weight:600;">â† Voltar</a>
    </nav>

    <div class="container" style="min-height: 80vh; display: flex; align-items: center; justify-content: center;">
        
        <div id="menuScreen" style="width: 100%;">
            <div style="text-align: center; margin-bottom: 40px;">
                <h1 style="margin-bottom: 10px;">Escolha a Ãrea</h1>
                <p style="color:var(--text-muted);">Filtre as questÃµes para focar no seu ponto fraco.</p>
            </div>

            <div class="subjects-grid">
                <div class="subject-card" data-type="humanas" onclick="startQuiz('Humanas')">
                    <span class="subject-icon">ğŸ›ï¸</span>
                    <span class="subject-title">CiÃªncias Humanas</span>
                    <span class="subject-count">HistÃ³ria, Geo, Filo</span>
                </div>
                <div class="subject-card" data-type="natureza" onclick="startQuiz('Natureza')">
                    <span class="subject-icon">ğŸ§¬</span>
                    <span class="subject-title">CiÃªncias da Natureza</span>
                    <span class="subject-count">Bio, QuÃ­m, FÃ­s</span>
                </div>
                <div class="subject-card" data-type="linguagens" onclick="startQuiz('Linguagens')">
                    <span class="subject-icon">ğŸ“š</span>
                    <span class="subject-title">Linguagens</span>
                    <span class="subject-count">PortuguÃªs, Lit, Artes</span>
                </div>
                <div class="subject-card" data-type="matematica" onclick="startQuiz('MatemÃ¡tica')">
                    <span class="subject-icon">ğŸ“</span>
                    <span class="subject-title">MatemÃ¡tica</span>
                    <span class="subject-count">LÃ³gica, Geometria</span>
                </div>
                <div class="subject-card" onclick="startQuiz('Geral')" style="border-color: var(--primary);">
                    <span class="subject-icon">ğŸ²</span>
                    <span class="subject-title">Simulado Geral</span>
                    <span class="subject-count">Mistura de tudo</span>
                </div>
            </div>
        </div>

        <div id="quizScreen" class="quiz-container" style="display: none;">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <span class="badge-subject" id="subjectTag">Geral</span>
                <span style="font-weight:600; color:var(--text-muted);">QuestÃ£o <span id="qIndex">1</span>/5</span>
            </div>
            <div class="question-text" id="questionText">...</div>
            <div class="options-grid" id="optionsContainer"></div>
        </div>

        <div id="resultScreen" class="quiz-container" style="display: none;">
            <div style="font-size: 4rem;">ğŸ†</div>
            <h2 style="margin-bottom: 10px;">Resultado</h2>
            <div class="quiz-score" id="finalScore">0/5</div>
            <p id="feedbackText" style="margin-bottom: 30px; color:var(--text-muted);">...</p>
            <div style="display:flex; gap:10px; justify-content:center;">
                <button class="btn" onclick="location.reload()">Escolher Outra</button>
            </div>
        </div>

    </div>

    <script>
        // --- BANCO DE DADOS (Expandido e Categorizado) ---
        const database = [
            // LINGUAGENS
            { cat: "Linguagens", txt: "O que caracteriza a 'fuga ao tema' na redaÃ§Ã£o?", opt: ["Erros gramaticais", "NÃ£o abordar o assunto central", "Texto curto", "Letra feia"], cor: 1 },
            { cat: "Linguagens", txt: "Qual funÃ§Ã£o da linguagem foca no receptor?", opt: ["Emotiva", "MetalinguÃ­stica", "Conativa", "Referencial"], cor: 2 },
            { cat: "Linguagens", txt: "O movimento Modernista de 1922 criticava:", opt: ["O Parnasianismo", "O Barroco", "O Realismo", "O Simbolismo"], cor: 0 },
            
            // HUMANAS
            { cat: "Humanas", txt: "A 'Guerra Fria' foi um conflito ideolÃ³gico entre:", opt: ["EUA e China", "Alemanha e FranÃ§a", "EUA e URSS", "Inglaterra e JapÃ£o"], cor: 2 },
            { cat: "Humanas", txt: "O conceito de 'Mais-valia' pertence a:", opt: ["Max Weber", "Karl Marx", "Durkheim", "Adam Smith"], cor: 1 },
            { cat: "Humanas", txt: "Qual o bioma predominante no Centro-Oeste?", opt: ["AmazÃ´nia", "Caatinga", "Cerrado", "Mata AtlÃ¢ntica"], cor: 2 },

            // NATUREZA
            { cat: "Natureza", txt: "Qual a organela responsÃ¡vel pela respiraÃ§Ã£o celular?", opt: ["Ribossomo", "MitocÃ´ndria", "Lisossomo", "Golgi"], cor: 1 },
            { cat: "Natureza", txt: "Na tabela periÃ³dica, o 'Na' representa:", opt: ["NitrogÃªnio", "NÃ­quel", "SÃ³dio", "NeÃ´nio"], cor: 2 },
            { cat: "Natureza", txt: "A 1Âª Lei de Newton Ã© conhecida como:", opt: ["Lei da AÃ§Ã£o e ReaÃ§Ã£o", "Lei da InÃ©rcia", "Lei da Gravidade", "Lei da ForÃ§a"], cor: 1 },

            // MATEMÃTICA
            { cat: "MatemÃ¡tica", txt: "Quanto Ã© 20% de 500?", opt: ["50", "100", "150", "200"], cor: 1 },
            { cat: "MatemÃ¡tica", txt: "A soma dos Ã¢ngulos internos de um triÃ¢ngulo Ã©:", opt: ["180Â°", "360Â°", "90Â°", "270Â°"], cor: 0 },
            { cat: "MatemÃ¡tica", txt: "Bhaskara Ã© usada para equaÃ§Ãµes de qual grau?", opt: ["Primeiro", "Segundo", "Terceiro", "Quarto"], cor: 1 }
        ];

        // VariÃ¡veis de Estado
        let quizPool = [];
        let currentIndex = 0;
        let score = 0;

        function startQuiz(category) {
            // Filtra por matÃ©ria ou pega tudo
            if (category === 'Geral') {
                quizPool = database.sort(() => 0.5 - Math.random()).slice(0, 5);
            } else {
                // Filtra pelo nome da categoria (ex: Humanas)
                const filtered = database.filter(q => q.cat.includes(category) || (category === 'Natureza' && q.cat === 'Natureza'));
                // Se tiver poucas perguntas, repete algumas (no futuro terÃ¡ banco maior)
                quizPool = filtered.sort(() => 0.5 - Math.random()).slice(0, 5);
            }

            if(quizPool.length === 0) return alert("Em breve mais questÃµes dessa matÃ©ria!");

            currentIndex = 0;
            score = 0;
            document.getElementById('subjectTag').innerText = category;
            
            // Troca de tela
            document.getElementById('menuScreen').style.display = 'none';
            document.getElementById('quizScreen').style.display = 'block';
            
            loadQuestion();
        }

        function loadQuestion() {
            const q = quizPool[currentIndex];
            document.getElementById('qIndex').innerText = currentIndex + 1;
            document.getElementById('questionText').innerText = q.txt;
            
            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';

            q.opt.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(index, q.cor, btn);
                container.appendChild(btn);
            });
        }

        function checkAnswer(selected, correct, btn) {
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true);

            if (selected === correct) {
                btn.classList.add('correct');
                score++;
            } else {
                btn.classList.add('wrong');
                allBtns[correct].classList.add('correct'); // Mostra a certa
            }

            setTimeout(() => {
                currentIndex++;
                if (currentIndex < quizPool.length) loadQuestion();
                else showResults();
            }, 1500);
        }

        function showResults() {
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'block';
            document.getElementById('finalScore').innerText = `${score}/${quizPool.length}`;
            
            const msg = document.getElementById('feedbackText');
            if (score === quizPool.length) msg.innerText = "Gabaritou! VocÃª Ã© uma mÃ¡quina! ğŸ¤–";
            else if (score > quizPool.length / 2) msg.innerText = "Mandou bem! Continue assim.";
            else msg.innerText = "NÃ£o desanime, revise o conteÃºdo!";
        }

        // --- AUTO-START VIA CRONOGRAMA ---
        // Verifica se o cronograma mandou abrir algo especÃ­fico
        const autoStart = localStorage.getItem('simulado_auto_start');
        if (autoStart) {
            // Limpa para nÃ£o rodar sempre que der F5
            localStorage.removeItem('simulado_auto_start');
            // Inicia o quiz automaticamente
            startQuiz(autoStart);
        }
    </script>
</body>
</html>
